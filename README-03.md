## [목록으로](README.md)

## 3. 스프링 부트 3 구조 이해하기

### 3.1 스프링 부트 3 구조 살펴보기

* 각 계층이 양 옆의 계층과 통신하는 구조
* 계층이라는 것은 각자의 역할과 책임이 있는 소프트웨어의 구성 요소
* 각 계층은 서로 소통할 수는 있지만 다른 계층에 직접 간섭하거나 영향을 미칮지 않음

#### 3.1.1 카페와 빵집으로 이해하는 계층

* 각 계층은 자신의 책임에 맞는 역할(커피 팔기, 빵 팔기)을 수행하며, 필요에 따라 소통(카피 사면 빵 할인)
* 스프링 부트에는 프레젠테이션, 비즈니스, 퍼시슽ㄴ스 계층이 있으며 이 계층이 서로 통신하며 프로그램을 구성

> #### 프레젠테이션 계층
> HTTP 요청을 받고 이 요청을 비즈니스 계층으로 전송하는 역할
> 컨트롤러가 바로 프레젠테이션 계층의 역할
> #### 비즈니스 계층
> 모든 비즈니스 로직을 처리 (서비스를 만들기 위한 로직)
> 주문 서비스라고 한다면 주문 개수, 가격 등의 데이터를 처리하기 위한 로직, 주문 처리를 하다가 발생하는 예외 처리 로직, 주문을 받거나 취소하는 것 같이 프로세스를 구현하기 위한 로직
> #### 퍼시스턴스 계층
> 모든 데이터베이스 관련 로직을 처리
> 이 과정에서 데이터베이스에 접근하는 DAO 객체를 사용
> 리포지토리가 퍼시스턴스 계층의 역할

#### 3.1.2 스프링 부트 프로젝트 디렉터리 구성하며 살펴보기

> #### main
> 실제 코드를 작성하는 공간. 프로젝트 실행에 필요한 소스 코드나 리소스 파일 위치
> #### test
> 프로젝트의 소스 코드를 테스트 할 목적의 코드나 리소스 파일 위치
> #### build.gradle
> 빌드를 설정하는 파일 (의존성이나 플러그인 설정 등과 같이 빌드에 필요한 설정을 할 때 사용)
> #### setting.gradle
> 빌드할 프로젝트의 정보를 설정하는 파일

#### 3.1.3 main 디렉터리 구성하기

1. main/resources/templates 디렉토리 생성
2. main/resources/static 디렉토리 생성
3. main/resources/application.yml 파일 생성

### 3.2 스프리으 부트 3 프로젝트 발전시키기

의존성을 추가한 다음 프레젠테이션 계층, 비즈니스 계층, 퍼시스턴스 계층 순서대로 코드 추가

#### 3.2.1 build.gradle 에 의존성 추가히기

1. 스프링 부트용 JPA 인 스프링 데이터 JPA, 로컬 환경과 테스트 환경에서 사용할 인메모리 데이터베이스인 H2, 반복 메서드 작성 작업을 줄여주는 라이브러리인 롬복 추가
2. [Gradle] 탭에서 새로고침 버튼을 누르면서 앞서 추가한 의존성을 다운로드

#### 3.2.2 프레젠테이션, 서비스, 퍼시스턴스 계층 만들기

1. 프리젠테이션 계층 - TestController.java 클래스 
2. 비즈니스 계층 - TestService.java 클래스
3. 퍼시스턴트 계층 - Member.java 클래스
4. 퍼시스턴트 계층 - MemberRepository.java 인터페이스

#### 3.2.3 임포트 오류 처리하기

Alt+Enter 누른 후 [Import class]

#### 3.2.4 작동 확인

* 지금의 경우 결과물을 볼 수 있는 데이터가 데이터베이스에 하나도 입력되지 않은 상태
* 인메모리 데이터베이스를 사용하고 있기 때문에 애플리케이션을 실행할 때 원하는 데이터를 자동으로 넣는 작업 진행

1. resources 디렉터리에 data.sql 파일을 생성하고 INSERT 쿼리문 작성
2. application.yml jpa 옵션 수정
3. 빌드 후 CREATE TABLE 확인
4. 포스트맨으로 HTTP 요청 시도 (http://localhost:8080/test)
